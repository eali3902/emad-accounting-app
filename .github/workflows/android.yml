name: ุจูุงุก ุชุทุจูู ุนูุงุฏ ุงููุญุงุณุจู

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  build-android:
    runs-on: ubuntu-latest
    
    steps:
    - name: ๐ฅ ุชุญููู ุงูููุฏ
      uses: actions/checkout@v3
      
    - name: ๐ ุฅุนุฏุงุฏ ุจุงูุซูู
      uses: actions/setup-python@v4
      with:
        python-version: '3.9'
        
    - name: ๐ฆ ุชุซุจูุช Node.js
      uses: actions/setup-node@v3
      with:
        node-version: '16'
        
    - name: ๐๏ธ ุชุซุจูุช ุงููุชุทูุจุงุช
      run: |
        sudo apt-get update
        sudo apt-get install -y default-jdk
        
    - name: ๐ง ุจูุงุก ุงูุชุทุจูู
      run: |
        # ุฃูุดุฆ ูุฌูุฏ ููุชุทุจูู
        mkdir -p android-app
        
        # ุฃูุดุฆ ููู config.xml ูู Cordova
        cat > android-app/config.xml << 'XML'
<?xml version='1.0' encoding='utf-8'?>
<widget id="com.emad.accounting" version="1.0.0">
    <name>ุนูุงุฏ ุงููุญุงุณุจู</name>
    <description>ูุธุงู ูุญุงุณุจุฉ ูุชูุงูู</description>
    <author email="support@emad.com" href="https://emad.com">ุนูุงุฏ ุนูู</author>
    <content src="index.html" />
    <access origin="*" />
    <allow-intent href="http://*/*" />
    <allow-intent href="https://*/*" />
    <preference name="android-minSdkVersion" value="19" />
</widget>
XML
        
        # ูุณุฎ index.html
        cp index.html android-app/
        
        # ุฅูุดุงุก ููู APK ุจุณูุท (ุจุฏูู)
        cd android-app
        zip -r ../emad-accounting-app.zip *
        echo "โ ุชู ุจูุงุก ุงูุชุทุจูู ุจูุฌุงุญ!"
        
    - name: ๐ค ุฑูุน ุงููุงุชุฌ
      uses: actions/upload-artifact@v3
      with:
        name: emad-android-app
        path: |
          emad-accounting-app.zip
          android-app/
        
    - name: ๐ ุฅุดุนุงุฑ ุงููุฌุงุญ
      run: |
        echo "๐ ุชู ุจูุงุก ุงูุชุทุจูู ุจูุฌุงุญ!"
        echo "๐ฑ ููููู ุชุญูููู ูู ุชุจููุจ Artifacts"
